{% extends "calendar.html" %}

{% block calendar %}

<form action="" method="POST" class="">
    {{ form.hidden_tag() }}
    {% set found = {'found': False} %}
    <table>
        <thead>
            <tr>
                <th></th>
                {% for day in days %}
                    <th>
                        {{ day.strftime('%A') }}<br>
                        {{ day.strftime('%d-%m') }}
                    </th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for start_turn, end_turn in turns %}
            <tr>
                <td class="workout-time">
                    {{ start_turn.strftime('%H:%M') }}-{{ end_turn.strftime('%H:%M') }}
                </td>

                {% for day in days %}

                    {% if found.update({'found': False}) %}{% endif %}

                    {% for reservation, schedule in res_weightrooms if not found.get('found') %}

                        {% if schedule.day == day and schedule.from_hour == start_turn
                                                  and schedule.to_hour == end_turn %}
                            <td class="hover-bg ts-item">
                                <h6>GYM</h6>
                                <span>
                                    {{ schedule.from_hour.strftime('%H:%M') }}-{{ schedule.to_hour.strftime('%H:%M') }}
                                </span>
                                <div class="trainer-name"></div>
                                <label class="my-checkbox">
                                    {% set checkbox = getattr(form, str(schedule.id)) %}
                                    {{ checkbox }}
                                <span class="checkmark"></span>
                                </label>
                            </td>
                            {% if found.update({'found': True}) %}{% endif %}
                        {% endif %}

                    {% endfor %}

                    {% for reservation, schedule, course in res_courses if not found.get('found') %}

                        {% if schedule.day == day and schedule.from_hour == start_turn
                                                  and schedule.to_hour == end_turn %}
                            <td class="hover-bg ts-item">
                                <h6>{{ course.name }}</h6>
                                <span>
                                    {{ schedule.from_hour.strftime('%H:%M') }}-{{ schedule.to_hour.strftime('%H:%M') }}
                                </span>
                                <div class="trainer-name"></div>
                                <label class="my-checkbox">
                                    {% set checkbox = getattr(form, str(schedule.id)) %}
                                    {{ checkbox }}
                                <span class="checkmark"></span>
                                </label>
                            </td>
                            {% if found.update({'found': True}) %}{% endif %}
                        {% endif %}

                    {% endfor %}

                    {% if not found.get('found') %}
                        <td class="hover-bg ts-item"></td>
                    {% endif %}

                {% endfor %}

            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="calendar-submit">
        <div class="calendar-form">
            {{ form.submit(class="register-btn") }}
        </div>
    </div>

</form>

{% endblock %}>